(this["webpackJsonpfirebase-chatroom"]=this["webpackJsonpfirebase-chatroom"]||[]).push([[0],{43:function(e,t,n){},44:function(e,t,n){},58:function(e,t,n){},60:function(e,t,n){"use strict";n.r(t);var c=n(1),r=n.n(c),a=n(26),s=n.n(a),o=(n(43),n(44),n(9)),i=n(2),u=Object(c.createContext)({}),j=function(){return Object(c.useContext)(u)},b=function(e){var t=e.children,n=Object(c.useState)(null),r=Object(o.a)(n,2),a=r[0],s=r[1];return Object(i.jsx)(u.Provider,{value:{room:a,setRoom:s},children:t})},l=n(18);n(61),n(47);l.a.initializeApp({apiKey:"AIzaSyDMaoIYROv6pMp-kuGG1-hZ-VQRUgF7iq4",authDomain:"chatroom-904d0.firebaseapp.com",projectId:"chatroom-904d0",storageBucket:"chatroom-904d0.appspot.com",messagingSenderId:"620706504456",appId:"1:620706504456:web:f10f9366e67df2578156bd",measurementId:"G-RS7F424HR8"});var d=l.a,h=l.a.auth(),O=l.a.firestore(),m=n(37),f=n.n(m),x=n(28),p=n(6),v=function(){var e=j(),t=e.room,n=e.setRoom,c=Object(p.f)(),r=Object(x.a)(h);Object(o.a)(r,1)[0];return Object(i.jsxs)("div",{style:{display:"flex",flexDirection:"row"},children:[t&&Object(i.jsx)("button",{className:"signout-button",onClick:function(){n&&(n(null),c.push("/"))},children:"Quit Room"}),h.currentUser&&Object(i.jsxs)("button",{className:"signout-button",onClick:function(){h.signOut()},children:[Object(i.jsx)(f.a,{})," Sign Out"]})]})},g=function(){var e=j().room;return Object(i.jsxs)("div",{className:"header",children:[Object(i.jsxs)("h1",{children:["\ud83d\udcac ",e&&e.name]}),Object(i.jsx)(v,{})]})},N=function(){var e=Object(p.f)();return Object(i.jsxs)("div",{className:"chatroom-buttons",children:[Object(i.jsx)("button",{onClick:function(){e.push("/join")},children:"Join"}),Object(i.jsx)("button",{onClick:function(){e.push("/create")},children:"Create"})]})},k=n(19),w=n.n(k),R=n(22),I=n(33),C=n(23),S=n.n(C),y=function(e){var t,n=e.message,c=n.text,r=n.uid,a=n.photoURL,s=r===(null===(t=h.currentUser)||void 0===t?void 0:t.uid)?"sent":"received";return Object(i.jsxs)("div",{className:"message ".concat(s),children:[Object(i.jsx)("img",{src:a,alt:"User Profile Picture"}),Object(i.jsxs)("p",{className:"chat-text",children:[c," "]})]})},F=(n(58),function(){return Object(i.jsx)("div",{className:"chatroom-buttons",children:Object(i.jsx)("div",{className:"loader",children:"Loading..."})})}),U=function(){var e=Object(p.g)().chatroomId,t=j(),n=(t.room,t.setRoom,Object(p.f)()),r=O.collection("chatrooms").where("id","==",e),a=O.collection("messages"),s=a.where("chatroomId","==",e).orderBy("createdAt").limit(50),u=Object(I.a)(s,{idField:"id",transform:function(e){return e}}),b=Object(o.a)(u,1)[0],d=Object(I.b)(r,{idField:"id",transform:function(e){return e}}),m=Object(o.a)(d,2),f=m[0],x=m[1],v=Object(c.useState)(""),g=Object(o.a)(v,2),N=g[0],k=g[1],C=Object(c.useRef)(null),U=function(){var t=Object(R.a)(w.a.mark((function t(n){var c,r,s;return w.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n.preventDefault(),N.length){t.next=3;break}return t.abrupt("return");case 3:if(!h.currentUser){t.next=8;break}return c=h.currentUser,r=c.uid,s=c.photoURL,t.next=7,a.add({text:N,createdAt:l.a.firestore.FieldValue.serverTimestamp(),uid:r,photoURL:s,chatroomId:e});case 7:k("");case 8:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}();return Object(c.useEffect)((function(){var e;null===(e=C.current)||void 0===e||e.scrollIntoView({behavior:"smooth"})}),[b]),x?Object(i.jsx)(F,{}):(f&&f.length||n.push("/"),Object(i.jsxs)(i.Fragment,{children:[Object(i.jsxs)("div",{className:"chat-body",children:[b&&b.map((function(e){return Object(i.jsx)(y,{message:e},e.id)})),Object(i.jsx)("div",{ref:C})]}),Object(i.jsxs)("form",{onSubmit:U,children:[Object(i.jsx)("input",{value:N,onChange:function(e){k(e.target.value)}}),Object(i.jsx)("button",{type:"submit",children:Object(i.jsx)(S.a,{})})]})]}))},D=n(74),A=function(){var e=O.collection("chatrooms"),t=j().setRoom,n=Object(c.useState)(""),r=Object(o.a)(n,2),a=r[0],s=r[1],u=Object(p.f)(),b=function(){var n=Object(R.a)(w.a.mark((function n(c){var r;return w.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(c.preventDefault(),a.length){n.next=3;break}return n.abrupt("return");case 3:if(!h.currentUser){n.next=10;break}return r=Object(D.a)(),n.next=7,e.add({name:a,uid:h.currentUser.uid,createdAt:l.a.firestore.FieldValue.serverTimestamp(),id:r});case 7:n.sent,t&&t({id:r,name:a}),u.push("./".concat(r));case 10:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}();return Object(i.jsx)("div",{className:"chatroom-buttons",children:Object(i.jsxs)("form",{onSubmit:b,children:[Object(i.jsx)("input",{placeholder:"Room Name",value:a,onChange:function(e){s(e.target.value)}}),Object(i.jsx)("button",{type:"submit",children:Object(i.jsx)(S.a,{})})]})})},P=function(){var e=O.collection("chatrooms"),t=j().setRoom,n=Object(c.useState)(""),r=Object(o.a)(n,2),a=r[0],s=r[1],u=Object(p.f)(),b=function(){var n=Object(R.a)(w.a.mark((function n(c){var r,o,i;return w.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return c.preventDefault(),n.next=3,e.where("id","==",a).get();case 3:if(r=n.sent,(o=r.docs.map((function(e){return e.data()})))&&o.length){n.next=8;break}return s("No room with that id exists"),n.abrupt("return");case 8:i=o[0].id,t&&t(o[0]),u.push("/".concat(i));case 11:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}();return Object(i.jsx)("div",{className:"chatroom-buttons",children:Object(i.jsxs)("form",{onSubmit:b,children:[Object(i.jsx)("input",{placeholder:"Room ID",value:a,onChange:function(e){s(e.target.value)}}),Object(i.jsx)("button",{type:"submit",children:Object(i.jsx)(S.a,{})})]})})},L=function(){return Object(i.jsxs)(p.c,{children:[Object(i.jsx)(p.a,{exact:!0,path:"/",children:Object(i.jsx)(N,{})}),Object(i.jsx)(p.a,{exact:!0,path:"/create",children:Object(i.jsx)(A,{})}),Object(i.jsx)(p.a,{exact:!0,path:"/join",children:Object(i.jsx)(P,{})}),Object(i.jsx)(p.a,{path:"/:chatroomId",children:Object(i.jsx)(U,{})})]})},G=function(){return Object(i.jsx)("div",{className:"chatroom-buttons",children:Object(i.jsx)("button",{className:"signin-button",onClick:function(){var e=new d.auth.GoogleAuthProvider;h.signInWithPopup(e)},children:"Sign in with Google"})})},B=function(){var e=Object(x.a)(h),t=Object(o.a)(e,2),n=t[0];return t[1]?Object(i.jsx)("div",{className:"chat",children:Object(i.jsx)(F,{})}):Object(i.jsx)("div",{className:"chat",children:n?Object(i.jsx)(L,{}):Object(i.jsx)(G,{})})},T=n(20);var V=function(){return Object(i.jsx)(T.a,{children:Object(i.jsx)(b,{children:Object(i.jsxs)("div",{className:"App",children:[Object(i.jsx)(g,{}),Object(i.jsx)(B,{})]})})})},J=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,75)).then((function(t){var n=t.getCLS,c=t.getFID,r=t.getFCP,a=t.getLCP,s=t.getTTFB;n(e),c(e),r(e),a(e),s(e)}))};s.a.render(Object(i.jsx)(r.a.StrictMode,{children:Object(i.jsx)(V,{})}),document.getElementById("root")),J()}},[[60,1,2]]]);
//# sourceMappingURL=main.e1213df5.chunk.js.map